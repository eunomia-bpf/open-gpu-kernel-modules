<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.42.4 (0)
 -->
<!-- Title: uvm_fault_service Pages: 1 -->
<svg width="1959pt" height="697pt"
 viewBox="0.00 0.00 1959.00 696.74" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 692.74)">
<title>uvm_fault_service</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-692.74 1955,-692.74 1955,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_legend</title>
<polygon fill="white" stroke="black" points="1064,-605.74 1064,-680.74 1943,-680.74 1943,-605.74 1064,-605.74"/>
<text text-anchor="middle" x="1503.5" y="-665.54" font-family="Times,serif" font-size="14.00">Legend</text>
</g>
<!-- entry -->
<g id="node1" class="node">
<title>entry</title>
<path fill="yellow" stroke="black" stroke-width="2" d="M1042,-650.74C1042,-650.74 744,-650.74 744,-650.74 738,-650.74 732,-644.74 732,-638.74 732,-638.74 732,-624.74 732,-624.74 732,-618.74 738,-612.74 744,-612.74 744,-612.74 1042,-612.74 1042,-612.74 1048,-612.74 1054,-618.74 1054,-624.74 1054,-624.74 1054,-638.74 1054,-638.74 1054,-644.74 1048,-650.74 1042,-650.74"/>
<text text-anchor="middle" x="893" y="-635.54" font-family="Times,serif" font-size="14.00">uvm_parent_gpu_service_replayable_faults</text>
<text text-anchor="middle" x="893" y="-620.54" font-family="Times,serif" font-size="14.00">(Line 2906)</text>
</g>
<!-- init -->
<g id="node2" class="node">
<title>init</title>
<path fill="lightblue" stroke="black" d="M704.5,-553.87C704.5,-553.87 591.5,-553.87 591.5,-553.87 585.5,-553.87 579.5,-547.87 579.5,-541.87 579.5,-541.87 579.5,-527.87 579.5,-527.87 579.5,-521.87 585.5,-515.87 591.5,-515.87 591.5,-515.87 704.5,-515.87 704.5,-515.87 710.5,-515.87 716.5,-521.87 716.5,-527.87 716.5,-527.87 716.5,-541.87 716.5,-541.87 716.5,-547.87 710.5,-553.87 704.5,-553.87"/>
<text text-anchor="middle" x="648" y="-538.67" font-family="Times,serif" font-size="14.00">uvm_tracker_init</text>
<text text-anchor="middle" x="648" y="-523.67" font-family="Times,serif" font-size="14.00">初始化tracker</text>
</g>
<!-- entry&#45;&gt;init -->
<g id="edge1" class="edge">
<title>entry&#45;&gt;init</title>
<path fill="none" stroke="darkblue" d="M846.34,-612.67C805.81,-596.98 747.02,-574.21 703.97,-557.54"/>
<polygon fill="darkblue" stroke="darkblue" points="705.07,-554.22 694.49,-553.87 702.55,-560.75 705.07,-554.22"/>
<text text-anchor="middle" x="805" y="-583.54" font-family="Times,serif" font-size="14.00">1</text>
</g>
<!-- loop -->
<g id="node3" class="node">
<title>loop</title>
<ellipse fill="lightgreen" stroke="black" cx="815" cy="-534.87" rx="80.72" ry="26.74"/>
<text text-anchor="middle" x="815" y="-538.67" font-family="Times,serif" font-size="14.00">Main Loop</text>
<text text-anchor="middle" x="815" y="-523.67" font-family="Times,serif" font-size="14.00">处理所有faults</text>
</g>
<!-- entry&#45;&gt;loop -->
<g id="edge2" class="edge">
<title>entry&#45;&gt;loop</title>
<path fill="none" stroke="darkblue" d="M877.96,-612.45C867.8,-600.09 854.1,-583.43 842.07,-568.8"/>
<polygon fill="darkblue" stroke="darkblue" points="844.65,-566.42 835.6,-560.92 839.24,-570.87 844.65,-566.42"/>
<text text-anchor="middle" x="869" y="-583.54" font-family="Times,serif" font-size="14.00">2</text>
</g>
<!-- final_replay -->
<g id="node4" class="node">
<title>final_replay</title>
<path fill="lightgreen" stroke="black" d="M1056,-553.87C1056,-553.87 926,-553.87 926,-553.87 920,-553.87 914,-547.87 914,-541.87 914,-541.87 914,-527.87 914,-527.87 914,-521.87 920,-515.87 926,-515.87 926,-515.87 1056,-515.87 1056,-515.87 1062,-515.87 1068,-521.87 1068,-527.87 1068,-527.87 1068,-541.87 1068,-541.87 1068,-547.87 1062,-553.87 1056,-553.87"/>
<text text-anchor="middle" x="991" y="-538.67" font-family="Times,serif" font-size="14.00">Final Replay Check</text>
<text text-anchor="middle" x="991" y="-523.67" font-family="Times,serif" font-size="14.00">(Line 3020)</text>
</g>
<!-- entry&#45;&gt;final_replay -->
<g id="edge3" class="edge">
<title>entry&#45;&gt;final_replay</title>
<path fill="none" stroke="darkblue" d="M911.9,-612.45C926.94,-597.88 948.18,-577.32 964.86,-561.18"/>
<polygon fill="darkblue" stroke="darkblue" points="967.41,-563.58 972.16,-554.11 962.54,-558.55 967.41,-563.58"/>
<text text-anchor="middle" x="950" y="-583.54" font-family="Times,serif" font-size="14.00">3</text>
</g>
<!-- cleanup -->
<g id="node5" class="node">
<title>cleanup</title>
<path fill="lightblue" stroke="black" d="M1228,-553.87C1228,-553.87 1098,-553.87 1098,-553.87 1092,-553.87 1086,-547.87 1086,-541.87 1086,-541.87 1086,-527.87 1086,-527.87 1086,-521.87 1092,-515.87 1098,-515.87 1098,-515.87 1228,-515.87 1228,-515.87 1234,-515.87 1240,-521.87 1240,-527.87 1240,-527.87 1240,-541.87 1240,-541.87 1240,-547.87 1234,-553.87 1228,-553.87"/>
<text text-anchor="middle" x="1163" y="-538.67" font-family="Times,serif" font-size="14.00">uvm_tracker_deinit</text>
<text text-anchor="middle" x="1163" y="-523.67" font-family="Times,serif" font-size="14.00">清理tracker</text>
</g>
<!-- entry&#45;&gt;cleanup -->
<g id="edge4" class="edge">
<title>entry&#45;&gt;cleanup</title>
<path fill="none" stroke="darkblue" d="M944.42,-612.67C989.37,-596.88 1054.69,-573.93 1102.21,-557.23"/>
<polygon fill="darkblue" stroke="darkblue" points="1103.5,-560.49 1111.77,-553.87 1101.18,-553.88 1103.5,-560.49"/>
<text text-anchor="middle" x="1042" y="-583.54" font-family="Times,serif" font-size="14.00">4</text>
</g>
<!-- check_limits -->
<g id="node6" class="node">
<title>check_limits</title>
<path fill="lightyellow" stroke="black" d="M1531.54,-438.43C1531.54,-438.43 1384.46,-392.57 1384.46,-392.57 1378.73,-390.79 1378.73,-387.21 1384.46,-385.43 1384.46,-385.43 1531.54,-339.57 1531.54,-339.57 1537.27,-337.79 1548.73,-337.79 1554.46,-339.57 1554.46,-339.57 1701.54,-385.43 1701.54,-385.43 1707.27,-387.21 1707.27,-390.79 1701.54,-392.57 1701.54,-392.57 1554.46,-438.43 1554.46,-438.43 1548.73,-440.21 1537.27,-440.21 1531.54,-438.43"/>
<text text-anchor="middle" x="1543" y="-400.3" font-family="Times,serif" font-size="14.00">Check:</text>
<text text-anchor="middle" x="1543" y="-385.3" font-family="Times,serif" font-size="14.00">num_throttled &lt; max</text>
<text text-anchor="middle" x="1543" y="-370.3" font-family="Times,serif" font-size="14.00">num_batches &lt; max</text>
</g>
<!-- loop&#45;&gt;check_limits -->
<g id="edge5" class="edge">
<title>loop&#45;&gt;check_limits</title>
<path fill="none" stroke="darkblue" d="M872.26,-515.83C883.06,-512.88 894.31,-510.11 905,-508 976.94,-493.82 996.34,-499.89 1069,-490 1200.62,-472.08 1234.42,-471.25 1364,-442 1392.38,-435.59 1422.9,-427.27 1450.56,-419.18"/>
<polygon fill="darkblue" stroke="darkblue" points="1451.62,-422.51 1460.22,-416.32 1449.63,-415.8 1451.62,-422.51"/>
<text text-anchor="middle" x="1302" y="-471.3" font-family="Times,serif" font-size="14.00">检查限制</text>
</g>
<!-- reset_counters -->
<g id="node7" class="node">
<title>reset_counters</title>
<path fill="lightblue" stroke="black" d="M158,-423C158,-423 12,-423 12,-423 6,-423 0,-417 0,-411 0,-411 0,-367 0,-367 0,-361 6,-355 12,-355 12,-355 158,-355 158,-355 164,-355 170,-361 170,-367 170,-367 170,-411 170,-411 170,-417 164,-423 158,-423"/>
<text text-anchor="middle" x="85" y="-407.8" font-family="Times,serif" font-size="14.00">Reset:</text>
<text text-anchor="middle" x="85" y="-392.8" font-family="Times,serif" font-size="14.00">num_invalid_prefetch</text>
<text text-anchor="middle" x="85" y="-377.8" font-family="Times,serif" font-size="14.00">num_duplicates</text>
<text text-anchor="middle" x="85" y="-362.8" font-family="Times,serif" font-size="14.00">num_replays</text>
</g>
<!-- loop&#45;&gt;reset_counters -->
<g id="edge6" class="edge">
<title>loop&#45;&gt;reset_counters</title>
<path fill="none" stroke="darkblue" d="M758.8,-515.58C747.7,-512.57 736.07,-509.84 725,-508 483.9,-467.8 406.32,-531.84 179,-442 168.91,-438.01 158.55,-433.15 148.56,-428.02"/>
<polygon fill="darkblue" stroke="darkblue" points="149.99,-424.82 139.51,-423.25 146.73,-431.01 149.99,-424.82"/>
<text text-anchor="middle" x="398" y="-471.3" font-family="Times,serif" font-size="14.00">重置计数器</text>
</g>
<!-- fetch -->
<g id="node8" class="node">
<title>fetch</title>
<path fill="lightcoral" stroke="black" d="M375.5,-408C375.5,-408 200.5,-408 200.5,-408 194.5,-408 188.5,-402 188.5,-396 188.5,-396 188.5,-382 188.5,-382 188.5,-376 194.5,-370 200.5,-370 200.5,-370 375.5,-370 375.5,-370 381.5,-370 387.5,-376 387.5,-382 387.5,-382 387.5,-396 387.5,-396 387.5,-402 381.5,-408 375.5,-408"/>
<text text-anchor="middle" x="288" y="-392.8" font-family="Times,serif" font-size="14.00">fetch_fault_buffer_entries</text>
<text text-anchor="middle" x="288" y="-377.8" font-family="Times,serif" font-size="14.00">(Line 2933)</text>
</g>
<!-- loop&#45;&gt;fetch -->
<g id="edge7" class="edge">
<title>loop&#45;&gt;fetch</title>
<path fill="none" stroke="darkblue" d="M757.75,-515.79C746.95,-512.85 735.69,-510.08 725,-508 649.99,-493.39 628.88,-505.24 554,-490 482.5,-475.45 465,-468.45 397,-442 375.07,-433.47 351.42,-422.43 331.77,-412.71"/>
<polygon fill="darkblue" stroke="darkblue" points="333.27,-409.55 322.76,-408.21 330.14,-415.81 333.27,-409.55"/>
<text text-anchor="middle" x="589" y="-471.3" font-family="Times,serif" font-size="14.00">获取faults</text>
</g>
<!-- preprocess -->
<g id="node10" class="node">
<title>preprocess</title>
<path fill="lightcoral" stroke="black" d="M576,-408C576,-408 418,-408 418,-408 412,-408 406,-402 406,-396 406,-396 406,-382 406,-382 406,-376 412,-370 418,-370 418,-370 576,-370 576,-370 582,-370 588,-376 588,-382 588,-382 588,-396 588,-396 588,-402 582,-408 576,-408"/>
<text text-anchor="middle" x="497" y="-392.8" font-family="Times,serif" font-size="14.00">preprocess_fault_batch</text>
<text text-anchor="middle" x="497" y="-377.8" font-family="Times,serif" font-size="14.00">(Line 2942)</text>
</g>
<!-- loop&#45;&gt;preprocess -->
<g id="edge9" class="edge">
<title>loop&#45;&gt;preprocess</title>
<path fill="none" stroke="darkblue" d="M756.79,-516.25C734.36,-508.9 708.7,-499.79 686,-490 632.89,-467.09 574.43,-435.03 536.79,-413.44"/>
<polygon fill="darkblue" stroke="darkblue" points="538.1,-410.15 527.69,-408.19 534.6,-416.22 538.1,-410.15"/>
<text text-anchor="middle" x="707.5" y="-471.3" font-family="Times,serif" font-size="14.00">预处理</text>
</g>
<!-- service -->
<g id="node12" class="node">
<title>service</title>
<path fill="orange" stroke="black" stroke-width="2" d="M748,-415.5C748,-415.5 618,-415.5 618,-415.5 612,-415.5 606,-409.5 606,-403.5 606,-403.5 606,-374.5 606,-374.5 606,-368.5 612,-362.5 618,-362.5 618,-362.5 748,-362.5 748,-362.5 754,-362.5 760,-368.5 760,-374.5 760,-374.5 760,-403.5 760,-403.5 760,-409.5 754,-415.5 748,-415.5"/>
<text text-anchor="middle" x="683" y="-400.3" font-family="Times,serif" font-size="14.00">service_fault_batch</text>
<text text-anchor="middle" x="683" y="-385.3" font-family="Times,serif" font-size="14.00">(Line 2951)</text>
<text text-anchor="middle" x="683" y="-370.3" font-family="Times,serif" font-size="14.00">⭐核心处理</text>
</g>
<!-- loop&#45;&gt;service -->
<g id="edge11" class="edge">
<title>loop&#45;&gt;service</title>
<path fill="none" stroke="darkblue" d="M780.53,-510.36C772.43,-504.16 764.1,-497.18 757,-490 737.19,-469.99 718.37,-444.42 704.66,-424.15"/>
<polygon fill="darkblue" stroke="darkblue" points="707.57,-422.2 699.11,-415.82 701.74,-426.08 707.57,-422.2"/>
<text text-anchor="middle" x="792" y="-471.3" font-family="Times,serif" font-size="14.00">服务faults</text>
</g>
<!-- handle_fatal -->
<g id="node15" class="node">
<title>handle_fatal</title>
<path fill="red" stroke="black" d="M933.5,-408C933.5,-408 790.5,-408 790.5,-408 784.5,-408 778.5,-402 778.5,-396 778.5,-396 778.5,-382 778.5,-382 778.5,-376 784.5,-370 790.5,-370 790.5,-370 933.5,-370 933.5,-370 939.5,-370 945.5,-376 945.5,-382 945.5,-382 945.5,-396 945.5,-396 945.5,-402 939.5,-408 933.5,-408"/>
<text text-anchor="middle" x="862" y="-392.8" font-family="Times,serif" font-size="14.00">cancel_faults_precise</text>
<text text-anchor="middle" x="862" y="-377.8" font-family="Times,serif" font-size="14.00">(Line 2974)</text>
</g>
<!-- loop&#45;&gt;handle_fatal -->
<g id="edge14" class="edge">
<title>loop&#45;&gt;handle_fatal</title>
<path fill="none" stroke="darkblue" d="M823.51,-507.82C831.83,-482.37 844.43,-443.77 852.93,-417.75"/>
<polygon fill="darkblue" stroke="darkblue" points="856.3,-418.71 856.08,-408.12 849.65,-416.54 856.3,-418.71"/>
<text text-anchor="middle" x="869.5" y="-471.3" font-family="Times,serif" font-size="14.00">处理fatal</text>
</g>
<!-- replay_decision -->
<g id="node16" class="node">
<title>replay_decision</title>
<polygon fill="yellow" stroke="black" stroke-width="2" points="1159,-427 963,-389 1159,-351 1355,-389 1159,-427"/>
<text text-anchor="middle" x="1159" y="-392.8" font-family="Times,serif" font-size="14.00">⭐ Replay Policy Decision</text>
<text text-anchor="middle" x="1159" y="-377.8" font-family="Times,serif" font-size="14.00">(Line 2986&#45;3007)</text>
</g>
<!-- loop&#45;&gt;replay_decision -->
<g id="edge15" class="edge">
<title>loop&#45;&gt;replay_decision</title>
<path fill="none" stroke="darkblue" d="M863.92,-513.41C922.83,-488.77 1022.18,-447.22 1089.14,-419.22"/>
<polygon fill="darkblue" stroke="darkblue" points="1090.49,-422.45 1098.37,-415.36 1087.79,-415.99 1090.49,-422.45"/>
<text text-anchor="middle" x="1026" y="-471.3" font-family="Times,serif" font-size="14.00">Replay决策</text>
</g>
<!-- do_final_replay -->
<g id="node21" class="node">
<title>do_final_replay</title>
<path fill="lightblue" stroke="black" d="M1934.5,-407C1934.5,-407 1743.5,-407 1743.5,-407 1737.5,-407 1731.5,-401 1731.5,-395 1731.5,-395 1731.5,-383 1731.5,-383 1731.5,-377 1737.5,-371 1743.5,-371 1743.5,-371 1934.5,-371 1934.5,-371 1940.5,-371 1946.5,-377 1946.5,-383 1946.5,-383 1946.5,-395 1946.5,-395 1946.5,-401 1940.5,-407 1934.5,-407"/>
<text text-anchor="middle" x="1839" y="-385.3" font-family="Times,serif" font-size="14.00">push_replay_on_parent_gpu</text>
</g>
<!-- final_replay&#45;&gt;do_final_replay -->
<g id="edge20" class="edge">
<title>final_replay&#45;&gt;do_final_replay</title>
<path fill="none" stroke="darkblue" d="M1044.22,-515.86C1054.97,-512.79 1066.26,-509.96 1077,-508 1190.07,-487.32 1220.59,-501.08 1335,-490 1507.51,-473.3 1555,-488.37 1722,-442 1748.24,-434.72 1776.15,-422.5 1798.14,-411.73"/>
<polygon fill="darkblue" stroke="darkblue" points="1799.79,-414.82 1807.17,-407.23 1796.66,-408.56 1799.79,-414.82"/>
<text text-anchor="middle" x="1714" y="-478.8" font-family="Times,serif" font-size="14.00">if ONCE</text>
<text text-anchor="middle" x="1714" y="-463.8" font-family="Times,serif" font-size="14.00">or num_replays==0</text>
</g>
<!-- fetch_hw -->
<g id="node9" class="node">
<title>fetch_hw</title>
<path fill="lightblue" stroke="black" d="M360.5,-270C360.5,-270 215.5,-270 215.5,-270 209.5,-270 203.5,-264 203.5,-258 203.5,-258 203.5,-229 203.5,-229 203.5,-223 209.5,-217 215.5,-217 215.5,-217 360.5,-217 360.5,-217 366.5,-217 372.5,-223 372.5,-229 372.5,-229 372.5,-258 372.5,-258 372.5,-264 366.5,-270 360.5,-270"/>
<text text-anchor="middle" x="288" y="-254.8" font-family="Times,serif" font-size="14.00">fault_buffer_read_get</text>
<text text-anchor="middle" x="288" y="-239.8" font-family="Times,serif" font-size="14.00">fault_buffer_read_put</text>
<text text-anchor="middle" x="288" y="-224.8" font-family="Times,serif" font-size="14.00">parse_fault_entry</text>
</g>
<!-- fetch&#45;&gt;fetch_hw -->
<g id="edge8" class="edge">
<title>fetch&#45;&gt;fetch_hw</title>
<path fill="none" stroke="darkblue" d="M288,-369.83C288,-347.42 288,-308.83 288,-280.37"/>
<polygon fill="darkblue" stroke="darkblue" points="291.5,-280.02 288,-270.02 284.5,-280.02 291.5,-280.02"/>
<text text-anchor="middle" x="317" y="-299.3" font-family="Times,serif" font-size="14.00">读取硬件</text>
</g>
<!-- classify -->
<g id="node11" class="node">
<title>classify</title>
<path fill="lightblue" stroke="black" d="M545,-270C545,-270 439,-270 439,-270 433,-270 427,-264 427,-258 427,-258 427,-229 427,-229 427,-223 433,-217 439,-217 439,-217 545,-217 545,-217 551,-217 557,-223 557,-229 557,-229 557,-258 557,-258 557,-264 551,-270 545,-270"/>
<text text-anchor="middle" x="492" y="-254.8" font-family="Times,serif" font-size="14.00">classify_fault</text>
<text text-anchor="middle" x="492" y="-239.8" font-family="Times,serif" font-size="14.00">check_duplicate</text>
<text text-anchor="middle" x="492" y="-224.8" font-family="Times,serif" font-size="14.00">check_throttle</text>
</g>
<!-- preprocess&#45;&gt;classify -->
<g id="edge10" class="edge">
<title>preprocess&#45;&gt;classify</title>
<path fill="none" stroke="darkblue" d="M496.37,-369.83C495.59,-347.42 494.24,-308.83 493.25,-280.37"/>
<polygon fill="darkblue" stroke="darkblue" points="496.74,-279.89 492.89,-270.02 489.74,-280.14 496.74,-279.89"/>
<text text-anchor="middle" x="509.5" y="-299.3" font-family="Times,serif" font-size="14.00">分类</text>
</g>
<!-- service_managed -->
<g id="node13" class="node">
<title>service_managed</title>
<path fill="lightblue" stroke="black" d="M807,-261.5C807,-261.5 587,-261.5 587,-261.5 581,-261.5 575,-255.5 575,-249.5 575,-249.5 575,-237.5 575,-237.5 575,-231.5 581,-225.5 587,-225.5 587,-225.5 807,-225.5 807,-225.5 813,-225.5 819,-231.5 819,-237.5 819,-237.5 819,-249.5 819,-249.5 819,-255.5 813,-261.5 807,-261.5"/>
<text text-anchor="middle" x="697" y="-239.8" font-family="Times,serif" font-size="14.00">service_managed_fault_in_block</text>
</g>
<!-- service&#45;&gt;service_managed -->
<g id="edge12" class="edge">
<title>service&#45;&gt;service_managed</title>
<path fill="none" stroke="darkblue" d="M685.5,-362.35C687.99,-336.84 691.8,-297.85 694.34,-271.79"/>
<polygon fill="darkblue" stroke="darkblue" points="697.82,-272.11 695.31,-261.82 690.86,-271.43 697.82,-272.11"/>
<text text-anchor="middle" x="740" y="-299.3" font-family="Times,serif" font-size="14.00">处理managed</text>
</g>
<!-- make_resident -->
<g id="node14" class="node">
<title>make_resident</title>
<path fill="lightblue" stroke="black" d="M798,-102C798,-102 596,-102 596,-102 590,-102 584,-96 584,-90 584,-90 584,-76 584,-76 584,-70 590,-64 596,-64 596,-64 798,-64 798,-64 804,-64 810,-70 810,-76 810,-76 810,-90 810,-90 810,-96 804,-102 798,-102"/>
<text text-anchor="middle" x="697" y="-86.8" font-family="Times,serif" font-size="14.00">uvm_va_block_make_resident</text>
<text text-anchor="middle" x="697" y="-71.8" font-family="Times,serif" font-size="14.00">⭐Migration Decision</text>
</g>
<!-- service_managed&#45;&gt;make_resident -->
<g id="edge13" class="edge">
<title>service_managed&#45;&gt;make_resident</title>
<path fill="none" stroke="darkblue" d="M697,-225.24C697,-198.13 697,-145.31 697,-112.51"/>
<polygon fill="darkblue" stroke="darkblue" points="700.5,-112.22 697,-102.22 693.5,-112.22 700.5,-112.22"/>
<text text-anchor="middle" x="726" y="-187.8" font-family="Times,serif" font-size="14.00">迁移页面</text>
</g>
<!-- replay_batch -->
<g id="node17" class="node">
<title>replay_batch</title>
<path fill="lightblue" stroke="black" d="M1683.5,-270C1683.5,-270 1492.5,-270 1492.5,-270 1486.5,-270 1480.5,-264 1480.5,-258 1480.5,-258 1480.5,-229 1480.5,-229 1480.5,-223 1486.5,-217 1492.5,-217 1492.5,-217 1683.5,-217 1683.5,-217 1689.5,-217 1695.5,-223 1695.5,-229 1695.5,-229 1695.5,-258 1695.5,-258 1695.5,-264 1689.5,-270 1683.5,-270"/>
<text text-anchor="middle" x="1588" y="-254.8" font-family="Times,serif" font-size="14.00">push_replay_on_parent_gpu</text>
<text text-anchor="middle" x="1588" y="-239.8" font-family="Times,serif" font-size="14.00">REPLAY_TYPE_START</text>
<text text-anchor="middle" x="1588" y="-224.8" font-family="Times,serif" font-size="14.00">(Line 2987)</text>
</g>
<!-- replay_decision&#45;&gt;replay_batch -->
<g id="edge16" class="edge">
<title>replay_decision&#45;&gt;replay_batch</title>
<path fill="none" stroke="darkblue" d="M1229.36,-364.46C1303.94,-339.52 1421.79,-300.1 1501.87,-273.31"/>
<polygon fill="darkblue" stroke="darkblue" points="1503.07,-276.6 1511.44,-270.11 1500.85,-269.96 1503.07,-276.6"/>
<text text-anchor="middle" x="1498" y="-299.3" font-family="Times,serif" font-size="14.00">BATCH policy</text>
</g>
<!-- replay_batch_flush -->
<g id="node18" class="node">
<title>replay_batch_flush</title>
<path fill="lightblue" stroke="black" d="M1179.5,-270C1179.5,-270 1010.5,-270 1010.5,-270 1004.5,-270 998.5,-264 998.5,-258 998.5,-258 998.5,-229 998.5,-229 998.5,-223 1004.5,-217 1010.5,-217 1010.5,-217 1179.5,-217 1179.5,-217 1185.5,-217 1191.5,-223 1191.5,-229 1191.5,-229 1191.5,-258 1191.5,-258 1191.5,-264 1185.5,-270 1179.5,-270"/>
<text text-anchor="middle" x="1095" y="-254.8" font-family="Times,serif" font-size="14.00">fault_buffer_flush_locked</text>
<text text-anchor="middle" x="1095" y="-239.8" font-family="Times,serif" font-size="14.00">+ decide flush_mode</text>
<text text-anchor="middle" x="1095" y="-224.8" font-family="Times,serif" font-size="14.00">(Line 2992&#45;3006)</text>
</g>
<!-- replay_decision&#45;&gt;replay_batch_flush -->
<g id="edge17" class="edge">
<title>replay_decision&#45;&gt;replay_batch_flush</title>
<path fill="none" stroke="darkblue" d="M1143.67,-353.63C1133.64,-331.14 1120.58,-301.85 1110.51,-279.28"/>
<polygon fill="darkblue" stroke="darkblue" points="1113.67,-277.76 1106.4,-270.05 1107.27,-280.61 1113.67,-277.76"/>
<text text-anchor="middle" x="1182" y="-306.8" font-family="Times,serif" font-size="14.00">BATCH_FLUSH</text>
<text text-anchor="middle" x="1182" y="-291.8" font-family="Times,serif" font-size="14.00">policy</text>
</g>
<!-- no_replay -->
<g id="node20" class="node">
<title>no_replay</title>
<path fill="lightblue" stroke="black" d="M1330.5,-261.5C1330.5,-261.5 1221.5,-261.5 1221.5,-261.5 1215.5,-261.5 1209.5,-255.5 1209.5,-249.5 1209.5,-249.5 1209.5,-237.5 1209.5,-237.5 1209.5,-231.5 1215.5,-225.5 1221.5,-225.5 1221.5,-225.5 1330.5,-225.5 1330.5,-225.5 1336.5,-225.5 1342.5,-231.5 1342.5,-237.5 1342.5,-237.5 1342.5,-249.5 1342.5,-249.5 1342.5,-255.5 1336.5,-261.5 1330.5,-261.5"/>
<text text-anchor="middle" x="1276" y="-239.8" font-family="Times,serif" font-size="14.00">延迟到最后replay</text>
</g>
<!-- replay_decision&#45;&gt;no_replay -->
<g id="edge19" class="edge">
<title>replay_decision&#45;&gt;no_replay</title>
<path fill="none" stroke="darkblue" d="M1200.13,-358.59C1214.3,-347.06 1229.49,-333 1241,-318 1251.83,-303.88 1260.48,-285.86 1266.47,-271.2"/>
<polygon fill="darkblue" stroke="darkblue" points="1269.81,-272.27 1270.18,-261.68 1263.29,-269.72 1269.81,-272.27"/>
<text text-anchor="middle" x="1303.5" y="-306.8" font-family="Times,serif" font-size="14.00">ONCE policy</text>
<text text-anchor="middle" x="1303.5" y="-291.8" font-family="Times,serif" font-size="14.00">或其他</text>
</g>
<!-- hal_replay -->
<g id="node22" class="node">
<title>hal_replay</title>
<path fill="lightpink" stroke="black" stroke-width="2" d="M1803.5,-109.5C1803.5,-109.5 1654.5,-109.5 1654.5,-109.5 1648.5,-109.5 1642.5,-103.5 1642.5,-97.5 1642.5,-97.5 1642.5,-68.5 1642.5,-68.5 1642.5,-62.5 1648.5,-56.5 1654.5,-56.5 1654.5,-56.5 1803.5,-56.5 1803.5,-56.5 1809.5,-56.5 1815.5,-62.5 1815.5,-68.5 1815.5,-68.5 1815.5,-97.5 1815.5,-97.5 1815.5,-103.5 1809.5,-109.5 1803.5,-109.5"/>
<text text-anchor="middle" x="1729" y="-94.3" font-family="Times,serif" font-size="14.00">parent_gpu&#45;&gt;host_hal</text>
<text text-anchor="middle" x="1729" y="-79.3" font-family="Times,serif" font-size="14.00">&#45;&gt;replay_faults()</text>
<text text-anchor="middle" x="1729" y="-64.3" font-family="Times,serif" font-size="14.00">⭐HAL Callback Point</text>
</g>
<!-- replay_batch&#45;&gt;hal_replay -->
<g id="edge21" class="edge">
<title>replay_batch&#45;&gt;hal_replay</title>
<path fill="none" stroke="darkblue" d="M1610.97,-216.68C1635.11,-189.54 1673.17,-146.76 1699.51,-117.15"/>
<polygon fill="darkblue" stroke="darkblue" points="1702.24,-119.34 1706.28,-109.54 1697.01,-114.69 1702.24,-119.34"/>
</g>
<!-- flush_mode_decision -->
<g id="node19" class="node">
<title>flush_mode_decision</title>
<path fill="yellow" stroke="black" d="M1084.01,-161.17C1084.01,-161.17 916.99,-87.83 916.99,-87.83 911.49,-85.41 911.49,-80.59 916.99,-78.17 916.99,-78.17 1084.01,-4.83 1084.01,-4.83 1089.51,-2.41 1100.49,-2.41 1105.99,-4.83 1105.99,-4.83 1273.01,-78.17 1273.01,-78.17 1278.51,-80.59 1278.51,-85.41 1273.01,-87.83 1273.01,-87.83 1105.99,-161.17 1105.99,-161.17 1100.49,-163.59 1089.51,-163.59 1084.01,-161.17"/>
<text text-anchor="middle" x="1095" y="-109.3" font-family="Times,serif" font-size="14.00">⭐ Flush Mode Decision:</text>
<text text-anchor="middle" x="1095" y="-94.3" font-family="Times,serif" font-size="14.00">if (duplicates &gt; ratio)</text>
<text text-anchor="middle" x="1095" y="-79.3" font-family="Times,serif" font-size="14.00"> &#160;UPDATE_PUT</text>
<text text-anchor="middle" x="1095" y="-64.3" font-family="Times,serif" font-size="14.00">else</text>
<text text-anchor="middle" x="1095" y="-49.3" font-family="Times,serif" font-size="14.00"> &#160;CACHED_PUT</text>
</g>
<!-- replay_batch_flush&#45;&gt;flush_mode_decision -->
<g id="edge18" class="edge">
<title>replay_batch_flush&#45;&gt;flush_mode_decision</title>
<path fill="none" stroke="darkblue" d="M1095,-216.68C1095,-205.28 1095,-191.11 1095,-176.32"/>
<polygon fill="darkblue" stroke="darkblue" points="1098.5,-176.01 1095,-166.01 1091.5,-176.01 1098.5,-176.01"/>
<text text-anchor="middle" x="1116.5" y="-187.8" font-family="Times,serif" font-size="14.00">Policy</text>
</g>
<!-- do_final_replay&#45;&gt;hal_replay -->
<g id="edge22" class="edge">
<title>do_final_replay&#45;&gt;hal_replay</title>
<path fill="none" stroke="darkblue" d="M1832.77,-370.78C1815.26,-322.4 1765.36,-184.48 1741.72,-119.14"/>
<polygon fill="darkblue" stroke="darkblue" points="1744.98,-117.89 1738.29,-109.68 1738.4,-120.27 1744.98,-117.89"/>
</g>
<!-- l1 -->
<g id="node23" class="node">
<title>l1</title>
<polygon fill="yellow" stroke="black" points="1934.5,-649.74 1743.5,-649.74 1743.5,-613.74 1934.5,-613.74 1934.5,-649.74"/>
<text text-anchor="middle" x="1839" y="-628.04" font-family="Times,serif" font-size="14.00">Yellow = Policy Decision</text>
</g>
<!-- l2 -->
<g id="node24" class="node">
<title>l2</title>
<polygon fill="orange" stroke="black" points="1725,-649.74 1519,-649.74 1519,-613.74 1725,-613.74 1725,-649.74"/>
<text text-anchor="middle" x="1622" y="-628.04" font-family="Times,serif" font-size="14.00">Orange = Core Processing</text>
</g>
<!-- l3 -->
<g id="node25" class="node">
<title>l3</title>
<polygon fill="lightcoral" stroke="black" points="1500.5,-649.74 1307.5,-649.74 1307.5,-613.74 1500.5,-613.74 1500.5,-649.74"/>
<text text-anchor="middle" x="1404" y="-628.04" font-family="Times,serif" font-size="14.00">Coral = Major Functions</text>
</g>
<!-- l4 -->
<g id="node26" class="node">
<title>l4</title>
<polygon fill="lightpink" stroke="black" points="1289.5,-649.74 1072.5,-649.74 1072.5,-613.74 1289.5,-613.74 1289.5,-649.74"/>
<text text-anchor="middle" x="1181" y="-628.04" font-family="Times,serif" font-size="14.00">Pink = HAL Extension Point</text>
</g>
</g>
</svg>
